<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é‘‘è³ãƒªã‚¶ãƒ«ãƒˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400;700&display=swap" rel="stylesheet">
<script src="setlists.js"></script>

<style>
body{
  margin:0;
  font-family:"Zen Kaku Gothic New",sans-serif;
  background:linear-gradient(180deg,#f5fbfb,#ffffff);
  color:#333;
}
header{
  background:#39c5bb;
  color:#fff;
  padding:20px;
  text-align:center;
}
main{
  max-width:900px;
  margin:0 auto;
  padding:20px;
}
.card{
  background:#fff;
  border-radius:14px;
  padding:18px;
  margin-bottom:20px;
  box-shadow:0 6px 14px rgba(0,0,0,0.08);
}
h2{
  margin-top:0;
  color:#2c8f89;
}
.song{
  display:flex;
  justify-content:space-between;
  padding:6px 0;
  border-bottom:1px solid #eee;
}
.character{
  display:inline-block;
  padding:6px 12px;
  border-radius:999px;
  margin:4px;
  color:#fff;
  font-size:13px;
}
.miku{background:#39c5bb;}
.rin{background:#f5c400;}
.len{background:#ff9800;}
.luka{background:#e91e63;}
.meiko{background:#d32f2f;}
.kaito{background:#1e88e5;}
</style>
</head>

<body>

<header>
  <h1>ğŸ¶ é‘‘è³ãƒªã‚¶ãƒ«ãƒˆ</h1>
  <p>ã“ã‚Œã¾ã§ã®ãƒŸã‚¯ãƒ©ã‚¤ãƒ–ä½“é¨“ã‚’æŒ¯ã‚Šè¿”ã‚ã†</p>
</header>

<main>
  <div class="card" id="summary"></div>
  <div class="card" id="songRanking"></div>
  <div class="card" id="characterStats"></div>
</main>

<script>
const selected = JSON.parse(localStorage.getItem("selectedShows") || "[]");

const songCount = {};
const characterCount = {};

EVENTS.forEach(year=>{
  year.shows.forEach(show=>{
    if(!selected.includes(show.id)) return;

    show.songs.forEach(song=>{
      if(!songCount[song.title]){
        songCount[song.title] = {
          count:0,
          character:song.character
        };
      }
      songCount[song.title].count += 1;

      characterCount[song.character] =
        (characterCount[song.character] || 0) + 1;
    });
  });
});

// ã‚µãƒãƒªãƒ¼
document.getElementById("summary").innerHTML = `
  <h2>æ¦‚è¦</h2>
  <p>é¸æŠå…¬æ¼”æ•°ï¼š${selected.length}</p>
  <p>è¦–è´æ¥½æ›²æ•°ï¼š${Object.keys(songCount).length}</p>
`;

// æ›²ãƒ©ãƒ³ã‚­ãƒ³ã‚°
const ranking = Object.entries(songCount)
  .sort((a,b)=>b[1].count - a[1].count);

document.getElementById("songRanking").innerHTML = `
  <h2>æ¼”ç›®ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>
  ${ranking.map(([title,data])=>`
    <div class="song">
      <span>${title}</span>
      <strong>${data.count} å›</strong>
    </div>
  `).join("")}
`;

// ã‚­ãƒ£ãƒ©é›†è¨ˆ
document.getElementById("characterStats").innerHTML = `
  <h2>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åˆ¥</h2>
  ${Object.entries(characterCount).map(([ch,count])=>`
    <span class="character ${ch.toLowerCase()}">
      ${ch}ï¼š${count}
    </span>
  `).join("")}
`;
</script>

</body>
</html>
